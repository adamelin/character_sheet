{
  "formId": "form_root",
  "name": "Form root",
  "rmType": "FORM_DEFINITION",
  "viewConfig": {
    "label": {
      "custom": false,
      "value": "",
      "useLocalizations": false,
      "localizationsList": {}
    },
    "size": {
      "field": "inherit",
      "label": "inherit",
      "fill": "inherit"
    },
    "layout": {
      "valign": "inherit",
      "align": "inherit"
    },
    "tags": []
  },
  "language": "",
  "templateLanguages": [
    "en"
  ],
  "children": [
    {
      "name": "weight",
      "localizedName": "weight",
      "rmType": "DV_TEXT",
      "nodeId": "at0018",
      "min": 0,
      "max": 1,
      "localizedNames": {
        "en": "Name 3"
      },
      "localizedDescriptions": {
        "en": "*"
      },
      "aqlPath": "/content[openEHR-EHR-OBSERVATION.testing.v1]/data[at0001]/events[at0002]/data[at0003]/items[openEHR-EHR-CLUSTER.testing.v1]/items[at0018,'Name 3']/value",
      "inputs": [
        {
          "type": "TEXT"
        }
      ],
      "formId": "test_encounter/testing/testing/name_3",
      "viewConfig": {
        "size": {
          "field": "inherit",
          "label": "inherit",
          "fill": "inherit"
        },
        "layout": {
          "label": {
            "valign": "inherit",
            "align": "inherit"
          },
          "field": {
            "valign": "inherit",
            "align": "inherit"
          }
        },
        "label": {
          "custom": true
        },
        "advanced": {
          "hidden": false,
          "readonly": false
        },
        "tags": [
          "weight"
        ],
        "datasource": {
          "loadRemote": false,
          "loadRemoteUrl": "",
          "terminology": ""
        },
        "field": {
          "input": {
            "presentation": "textfield",
            "lines": "1"
          }
        }
      }
    },
    {
      "name": "height",
      "localizedName": "height",
      "rmType": "DV_TEXT",
      "nodeId": "at0018",
      "min": 0,
      "max": 1,
      "localizedNames": {
        "en": "Name 2"
      },
      "localizedDescriptions": {
        "en": "*"
      },
      "aqlPath": "/content[openEHR-EHR-OBSERVATION.testing.v1]/data[at0001]/events[at0002]/data[at0003]/items[openEHR-EHR-CLUSTER.testing.v1]/items[at0018,'Name 2']/value",
      "inputs": [
        {
          "type": "TEXT"
        }
      ],
      "formId": "test_encounter/testing/testing/name_2",
      "viewConfig": {
        "size": {
          "field": "inherit",
          "label": "inherit",
          "fill": "inherit"
        },
        "layout": {
          "label": {
            "valign": "inherit",
            "align": "inherit"
          },
          "field": {
            "valign": "inherit",
            "align": "inherit"
          }
        },
        "label": {
          "custom": true
        },
        "advanced": {
          "hidden": false,
          "readonly": false
        },
        "tags": [
          "height", "t2", "hideThis"
        ],
        "datasource": {
          "loadRemote": false,
          "loadRemoteUrl": "",
          "terminology": ""
        },
        "field": {
          "input": {
            "presentation": "textfield",
            "lines": "1"
          }
        }
      }
    },

    {
      "name": "Boolean1",
      "localizedName": "Boolean1",
      "rmType": "DV_BOOLEAN",
      "nodeId": "at0045",
      "min": 1,
      "max": 1,
      "localizedNames": {
        "en": "Boolean1"
      },
      "localizedDescriptions": {
        "en": "*"
      },
      "aqlPath": "/content[openEHR-EHR-OBSERVATION.testing.v1]/data[at0001]/events[at0002]/data[at0003]/items[openEHR-EHR-CLUSTER.testing.v1]/items[at0045]/value",
      "inputs": [
        {
          "type": "BOOLEAN"
        }
      ],
      "formId": "test_encounter/testing/testing/boolean1",
      "viewConfig": {
        "size": {
          "field": "inherit",
          "label": "inherit",
          "fill": "inherit"
        },
        "layout": {
          "label": {
            "valign": "inherit",
            "align": "inherit"
          },
          "field": {
            "valign": "inherit",
            "align": "inherit"
          }
        },
        "advanced": {
          "hidden": false,
          "readonly": false
        },
        "tags": ["changeMinBool"],
        "datasource": {
          "loadRemote": false,
          "loadRemoteUrl": "",
          "terminology": ""
        },
        "field": {
          "input": {
            "threeState": true
          }
        }
      }
    },


    {
      "name": "changeMin",
      "localizedName": "changeMin",
      "rmType": "DV_TEXT",
      "nodeId": "at00184",
      "min": 0,
      "max": 1,
      "localizedNames": {
        "en": "ChangeMin"
      },
      "localizedDescriptions": {
        "en": "*"
      },
      "aqlPath": "/content[openEHR-EHR-OBSERVATION.testing.v1]/data[at0001]/events[at00042]/data[at00043]/items[openEHR-EHR-CLUSTER.testing.v1]/items[at00184,'changeMin']/value",
      "inputs": [
        {
          "type": "TEXT"
        }
      ],
      "formId": "test_encounter/testing/testing/changeMin",
      "viewConfig": {
        "size": {
          "field": "inherit",
          "label": "inherit",
          "fill": "inherit"
        },
        "layout": {
          "label": {
            "valign": "inherit",
            "align": "inherit"
          },
          "field": {
            "valign": "inherit",
            "align": "inherit"
          }
        },
        "label": {
          "custom": true
        },
        "advanced": {
          "hidden": false,
          "readonly": false
        },
        "tags": [
          "changeMin", "changeMin0"
        ],
        "datasource": {
          "loadRemote": false,
          "loadRemoteUrl": "",
          "terminology": ""
        },
        "field": {
          "input": {
            "presentation": "textfield",
            "lines": "1"
          }
        }
      }
    },

    {
      "name": "changeMin1",
      "localizedName": "changeMin1",
      "rmType": "DV_TEXT",
      "nodeId": "at00184",
      "min": 0,
      "max": 1,
      "localizedNames": {
        "en": "ChangeMin1"
      },
      "localizedDescriptions": {
        "en": "*"
      },
      "aqlPath": "/content[openEHR-EHR-OBSERVATION.testing.v1]/data[at0001]/events[at00042]/data[at00043]/items[openEHR-EHR-CLUSTER.testing.v1]/items[at00184,'changeMin11']/value",
      "inputs": [
        {
          "type": "TEXT"
        }
      ],
      "formId": "test_encounter/testing/testing/changeMin11",
      "viewConfig": {
        "size": {
          "field": "inherit",
          "label": "inherit",
          "fill": "inherit"
        },
        "layout": {
          "label": {
            "valign": "inherit",
            "align": "inherit"
          },
          "field": {
            "valign": "inherit",
            "align": "inherit"
          }
        },
        "label": {
          "custom": true
        },
        "advanced": {
          "hidden": false,
          "readonly": false
        },
        "tags": [
          "changeMin", "changeMin1"
        ],
        "datasource": {
          "loadRemote": false,
          "loadRemoteUrl": "",
          "terminology": ""
        },
        "field": {
          "input": {
            "presentation": "textfield",
            "lines": "1"
          }
        }
      }
    },

    {
      "name": "Testing DV_CODED_TEXT",
      "localizedName": "Testing DV_CODED_TEXT",
      "rmType": "DV_CODED_TEXT",
      "nodeId": "at0027",
      "min": 0,
      "max": 1,
      "localizedNames": {
        "en": "Testing DV_CODED_TEXT1"
      },
      "localizedDescriptions": {
        "en": "*"
      },
      "aqlPath": "/content[openEHR-EHR-OBSERVATION.testing.v1]/data[at0001]/events[at0002]/data[at0003]/items[openEHR-EHR-CLUSTER.testing.v1]/items[at0027]/value1",
      "inputs": [
        {
          "suffix": "code",
          "type": "CODED_TEXT",
          "list": [
            {
              "value": "",
              "label": "",
              "localizedLabels": {
                "en": ""
              },
              "localizedDescriptions": {
                "en": ""
              }
            },
            {
              "value": "at0028",
              "label": "First",
              "localizedLabels": {
                "en": "First"
              },
              "localizedDescriptions": {
                "en": "First item"
              }
            },
            {
              "value": "at0029",
              "label": "Second",
              "localizedLabels": {
                "en": "Second"
              },
              "localizedDescriptions": {
                "en": "Second item"
              }
            },
            {
              "value": "at0030",
              "label": "Third",
              "localizedLabels": {
                "en": "Third"
              },
              "localizedDescriptions": {
                "en": "Third"
              }
            }
          ],
          "defaultValue": "at0029"
        }
      ],
      "formId": "test_encounter/testing/testing/testing_dv_coded_text1",
      "viewConfig": {
        "size": {
          "field": "inherit",
          "label": "inherit",
          "fill": "inherit"
        },
        "layout": {
          "field": {
            "valign": "inherit",
            "align": "inherit"
          }
        },
        "tags": ["changeMin"]
      }
    },

    {
      "name": "Testing DV_CODED_TEXT",
      "localizedName": "Testing DV_CODED_TEXT",
      "rmType": "DV_CODED_TEXT",
      "nodeId": "at0027",
      "min": 0,
      "max": 1,
      "localizedNames": {
        "en": "Testing DV_CODED_TEXT"
      },
      "localizedDescriptions": {
        "en": "*"
      },
      "aqlPath": "/content[openEHR-EHR-OBSERVATION.testing.v1]/data[at0001]/events[at0002]/data[at0003]/items[openEHR-EHR-CLUSTER.testing.v1]/items[at0027]/value",
      "inputs": [
        {
          "suffix": "code",
          "type": "CODED_TEXT",
          "list": [
            {
              "value": "",
              "label": "",
              "localizedLabels": {
                "en": ""
              },
              "localizedDescriptions": {
                "en": ""
              }
            },
            {
              "value": "at0028",
              "label": "First",
              "localizedLabels": {
                "en": "First"
              },
              "localizedDescriptions": {
                "en": "First item"
              }
            },
            {
              "value": "at0029",
              "label": "Second",
              "localizedLabels": {
                "en": "Second"
              },
              "localizedDescriptions": {
                "en": "Second item"
              }
            },
            {
              "value": "at0030",
              "label": "Third",
              "localizedLabels": {
                "en": "Third"
              },
              "localizedDescriptions": {
                "en": "Third"
              }
            }
          ],
          "defaultValue": "at0029"
        }
      ],
      "formId": "test_encounter/testing/testing/testing_dv_coded_text",
      "viewConfig": {
        "size": {
          "field": "inherit",
          "label": "inherit",
          "fill": "inherit"
        },
        "layout": {
          "field": {
            "valign": "inherit",
            "align": "inherit"
          }
        },
        "tags": ["bmiCoded"],
        "annotations": {"ehrFormScript": "api.log('TEST log bmiCoded tag field')"}
      }
    },

    {
      "name": "Name 3",
      "localizedName": "Name 3",
      "rmType": "DV_TEXT",
      "nodeId": "at0018",
      "min": 1,
      "max": 100,
      "localizedNames": {
        "en": "Name 3"
      },
      "localizedDescriptions": {
        "en": "*"
      },
      "aqlPath": "/content[openEHR-EHR-OBSERVATION.testing.v1]/data[at0001]/events[at0002]/data[at0003]/items[openEHR-EHR-CLUSTER.testing.v1]/items[at0018,'Name 3']/value",
      "inputs": [
        {
          "type": "TEXT"
        }
      ],
      "formId": "test_encounter/testing/testing/name_3:1",
      "viewConfig": {
        "size": {
          "field": "inherit",
          "label": "inherit",
          "fill": "inherit"
        },
        "layout": {
          "label": {
            "valign": "inherit",
            "align": "inherit"
          },
          "field": {
            "valign": "inherit",
            "align": "inherit"
          }
        },
        "advanced": {
          "hidden": false,
          "readonly": false
        },
        "tags": [
          "bmiValue", "t2", "hideThis"
        ],
        "datasource": {
          "loadRemote": false,
          "loadRemoteUrl": "",
          "terminology": ""
        },
        "field": {
          "input": {
            "presentation": "textfield",
            "lines": "1"
          }
        },
        "ehrFormScript": [
          "var bmiFn=function(h,w){ let wVal=parseFloat(w); let hVal=parseFloat(h); let bmiRaw = wVal * 10000 / hVal / hVal; let bmiVal = (Math.round(bmiRaw * 100) / 100); return !isNaN(bmiVal)?bmiVal:''; }; var fstVal=function(vObj){return vObj.value[0]}",
    "api.onChange('weight', function(v){ v=fstVal(v); if(v=='hide'){ api.hideFormElement('hideThis'); }else{ api.showFormElement('hideThis'); } if(v=='dis'){ api.disableFormElement('bmiValue'); }else{ api.enableFormElement('bmiValue'); } if(v=='70'){api.setFieldValue('height', '180');} if(v=='get'){api.log('GGETTT=', api.getFieldValue('bmiValue') );} if(v=='re'){ console.log("REQUIRED SET TRUE"); api.requireFormElement('changeMin', true); api.requireFormElement('changeMinBool', true); } if(v=='r'){ console.log("REQUIRED SET FALSE"); api.requireFormElement('changeMin', false); api.requireFormElement('changeMinBool', false); } });",
    "api.onEditStart('height', function(v){console.log('edit start TEST=',v)})",

    "api.onEditEnd('height', function(v){console.log('edit end TEST=',v)})",

    "api.onMouseOver('height', function(v){console.log('m over TEST=',v)})",

    "api.onMouseOut('height', function(v){console.log('m out TEST=',v)})",

    "api.onEnabledChange('bmiValue', function(v){console.log('ENABLED CHANGEEEE=',v)})",

    "api.onVisibilityChange('hideThis', function(v){console.log('VISIBILITY CHANGEEEE=',v)})",

    "api.onValidationChange('bmiValue', function(v){console.log('VALIDATION CHANGEEEE=',v)})",

    "api.addListener('weight', 'CHANGE', function(v){ api.setFieldValue('bmiValue', bmiFn(fstVal(api.getFieldValue('height')), fstVal(v)) ); }); api.addListener('height', 'CHANGE', function(v){ api.setFieldValue('bmiValue', bmiFn(fstVal(v),fstVal(api.getFieldValue('weight')) )); //if(fstVal(v)=='11')api.removeListener('height', 'CHANGE') }); api.addListener('bmiValue', 'CHANGE', function(v){ if(parseFloat(fstVal(v))>25){ api.setFieldValue('bmiCoded', 'at0030'); }else{ api.setFieldValue('bmiCoded','at0028'); } //if(fstVal(v)=='11')api.removeListener('height', 'CHANGE') })",

    "api.addListener('bmiValue', 'CHANGE', function(v){console.log('BMI CHANGEEEE=',v)})"
  ]
}
}
]
}
